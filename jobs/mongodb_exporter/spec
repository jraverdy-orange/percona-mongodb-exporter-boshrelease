---
name: mongodb_exporter

packages: 
  - mongodb_exporter

templates:
  bin/mongodb_exporter_ctl: bin/mongodb_exporter_ctl
  js/create_clustermonitor_user.js: js/create_clustermonitor_user.js
  bin/create_clustermonitor_user.sh: bin/create_clustermonitor_user.sh

consumes:
  - name: exporter
    type: mongodb_exporter
    
provides:
  - name: exporter
    type: mongodb_exporter

properties:
  collstats_colls:
    description: "List of comma separared databases.collections to get $collStats, example: db1.col1,db2.col2 "
  indexstats_colls:
    description: "List of comma separared databases.collections to get $indexStats, example: db1.col1,db2.col2"
  global_conn_pool:
    description: "Use global connection pool instead of creating new pool for each http request."
    default: false
  log_level:
    description: "Only log messages with the given severuty or above. Valid levels: [debug, info, warn, error, fatal]"
    default: error
  disable_diagnosticdata:
    description: "Disable collecting metrics from getDiagnosticData"
    default: false
  disable_replicasetstatus:
    description: "Disable collecting metrics from replSetGetStatus"
    default: false
  compatible_mode:
    description: "Enable old mongodb-exporter compatible metrics"
    default: false
  mongodb.bin_path:
    description: "Where mongoDB binaries are on the deployment"
  mongodb.clustermonitor.username:
    description: "User used for mongodb exporter"
  mongodb.clustermonitor.password:
    description: "Password used for mongodb exporter" 
  mongodb.clustermonitor.tls:
    description: "Enable tls connection with mongo server"
    default: false
  mongodb.clustermonitor.tls_ca:
    description: "MongoDB SSL CA (PEM encoded)"
  mongodb.root.username:
    description: ""
  mongodb.root.password:
    description: ""  
  mongodb.uri:
    description: "MongoDB connection URI to a single host, example: mongodb://user:pass@127.0.0.1:27017/admin?ssl=true"
  web.port:
    description: "Port on which to expose metrics and web interface"
    default: 9001
  web.metrics_path:
    description: "Path under which to expose metrics"